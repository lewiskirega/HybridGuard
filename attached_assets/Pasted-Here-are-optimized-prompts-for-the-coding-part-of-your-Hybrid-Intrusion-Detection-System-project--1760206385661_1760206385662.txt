Here are optimized prompts for the coding part of your Hybrid Intrusion Detection System project:

## **1. Complete System Setup Prompt**

```
Create a complete Python project structure for a Hybrid Intrusion Detection System with the following components:

REQUIREMENTS:
- Python 3.8+
- Use CIC-IDS2017 dataset for training
- Isolation Forest for anomaly detection
- Scapy for packet capture
- Tkinter for GUI
- Real-time monitoring capability

PROJECT STRUCTURE:
hybrid_ids/
├── main.py              # Main application entry point
├── requirements.txt     # Dependencies
├── src/
│   ├── __init__.py
│   ├── data_loader.py   # Dataset loading and preprocessing
│   ├── model_trainer.py # ML model training
│   ├── packet_sniffer.py # Real-time packet capture
│   ├── signature_detector.py # Rule-based detection
│   ├── anomaly_detector.py # ML-based detection
│   └── gui.py          # User interface
├── models/
│   └── isolation_forest_model.pkl
└── data/
    └── cic_ids_2017/    # Dataset files

Generate the complete code for each file with proper error handling and logging.
```

## **2. Data Preprocessing & Model Training Prompt**

```
Write Python code to preprocess the CIC-IDS2017 dataset and train an Isolation Forest model:

REQUIREMENTS:
1. Load CSV files from CIC-IDS2017 dataset
2. Handle missing values and data cleaning
3. Select relevant network features (flow duration, protocol, packet sizes, flags, etc.)
4. Encode categorical variables
5. Normalize numerical features
6. Split data: 70% training (normal traffic only), 30% testing
7. Train Isolation Forest model with optimal parameters
8. Evaluate model performance (accuracy, precision, recall, F1-score)
9. Save trained model as .pkl file

SPECIFIC FEATURES TO EXTRACT:
- Flow duration
- Protocol type
- Total packets
- Total bytes
- Packet size statistics (mean, std)
- TCP flags count
- Flow bytes/s, packets/s

Provide complete code with detailed comments and visualization of results.
```

## **3. Real-Time Packet Sniffer Prompt**

```
Create a real-time packet sniffer using Scapy with these capabilities:

FUNCTIONALITIES:
1. Capture packets from specified network interface
2. Extract features in real-time matching our ML model:
   - Timestamp, source/dest IP & port
   - Protocol type (TCP=6, UDP=17, ICMP=1)
   - Packet length
   - TCP flags (SYN, ACK, FIN, RST, etc.)
   - Flow statistics (ongoing)
3. Aggregate packets into flows (5-second windows)
4. Preprocess features to match training data format
5. Threaded implementation to avoid GUI blocking

CODE REQUIREMENTS:
- Use Scapy's AsyncSniffer for non-blocking capture
- Implement packet filtering (TCP/UDP/ICMP only)
- Feature extraction function
- Flow tracking dictionary
- Real-time feature normalization

Generate the complete PacketSniffer class with start/stop methods and callback for new flows.
```

## **4. Hybrid Detection Engine Prompt**

```
Build a hybrid detection engine that combines signature-based and ML-based detection:

SIGNATURE-BASED RULES (implement 5 rules):
1. SYN Flood detection: >100 SYN packets from single IP in 10s
2. Port scan detection: >20 unique ports from single IP in 30s
3. SQL injection pattern: payload contains ['OR 1=1', 'UNION SELECT', 'DROP TABLE']
4. XSS detection: payload contains ['<script>', 'javascript:']
5. Large ICMP packets (potential ping flood)

ML-BASED DETECTION:
- Load pre-trained Isolation Forest model
- Preprocess real-time features to match training format
- Predict anomaly score (-1 for anomaly, 1 for normal)
- Calculate confidence score

INTEGRATION:
- Run both detectors simultaneously
- Priority: Signature alerts > ML alerts
- Aggregate results with severity levels
- Generate comprehensive alerts with details

Provide complete Python class with methods for both detection types.
```

## **5. GUI Application Prompt**

```
Create a Tkinter GUI for the Hybrid IDS with these components:

MAIN WINDOW ELEMENTS:
1. Control Panel:
   - Start/Stop monitoring buttons
   - Network interface selector
   - Status indicator (Online/Offline)
   
2. Real-time Dashboard:
   - Packet counter
   - Alert counter (by severity)
   - CPU/Memory usage monitor
   
3. Alert Display:
   - Table showing: Time, Source IP, Destination IP, Alert Type, Severity
   - Color-coded alerts (Red: High, Yellow: Medium, Green: Low)
   - Auto-scroll with newest alerts
   
4. Log Section:
   - System events and errors
   - Export logs to file button

FUNCTIONALITIES:
- Real-time updates without freezing
- Alert sound notification for high severity
- Log rotation to prevent memory issues
- Responsive layout

Generate complete Tkinter application with all widgets and event handlers.
```

## **6. Specific Feature Implementation Prompts**

**For packet feature extraction:**
```
Write a Python function extract_packet_features(packet) that takes a Scapy packet and returns a dictionary with these features:
- timestamp, protocol, src_ip, dst_ip, src_port, dst_port
- packet_length, tcp_flags (as bitmask)
- flow_key (string identifier)
- is_new_flow (boolean)
Return None for non-IP packets or malformed data.
```

**For model inference:**
```
Create a function predict_anomaly(features_dict, model) that:
1. Takes real-time packet features dictionary
2. Converts to numpy array matching training format
3. Applies same preprocessing as training
4. Returns: (prediction, anomaly_score, confidence)
5. Handles feature mismatches gracefully
```

**For alert management:**
```
Build an AlertManager class with:
- add_alert(source, type, severity, description)
- get_recent_alerts(limit=50)
- save_alerts_to_file(filename)
- alert_statistics() returns counts by severity
Use threading.Lock for thread-safe operations.
```

## **Quick Debugging Prompt Template**
```
DEBUG THIS CODE:

[Paste your problematic code here]

ERROR: [Describe the error or unexpected behavior]

WHAT I'VE TRIED: [List your attempted fixes]

Please fix the code and explain what was wrong.
```

Use these prompts sequentially - start with the data preprocessing, then model training, then build the packet sniffer, detection engine, and finally integrate everything with the GUI.